#service_port
PORT 8080
SERV HTTP
PCMD r':Body>\s*<m:(\w+?)[\s>]'
PCMD r':Body>\s*<vol:(\w+?)[\s>]'
PCMD r':Body>\s*<ns1:(\w+?)[\s>]'
PCMD r'<ns1:Request>\s*?<(\w+?)[\s>]'
PISDNREQ '<name>+86(\d+)</name>'
PISDNRSP '<ISDN>\d+</ISDN>'
PIMSIREQ '<hss:IMSI>(\d+)</hss:IMSI>'
PIMSIRSP '<IMSI>\d+</IMSI>'

#request command
LGI
LST_GPRS
LST_SUB
LST_EPS
LST_CFALL
LST_CBAR
MOD_CB
ADD_SBR

#response head
HEAD_KEY: LGI_HEAD
Resp-Code: 307
Location: http://%s:%d/01M1U6kBFFxv39uhbpNMyvRPcmC5yblhjKeJCCr88SfWZBIJBeNXGBVtvcUoUCP2
Server: Huawei web server
Content-Type: text/xml; charset="utf-8"
Content-Length: %d

HEAD_KEY: COMM_HEAD
Resp-Code: 200
Server: Huawei web server
Content-Type: text/xml; charset="utf-8"
Content-Length: %d

#response body
LGI_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><LGIResponse xmlns="http://www.huawei.com/HLR9820/LGI" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc></Result></LGIResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

LST_GPRS_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><LST_GPRSResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc><ResultData><IMSI>460000694167613</IMSI><ISDN>8613910173348</ISDN><CHARGE_GLOBAL>PREPAID</CHARGE_GLOBAL><Group><CNTXID>1</CNTXID><QOSTPLID>33</QOSTPLID><PDPTYPE>IPV4</PDPTYPE><IPV4ADDIND>DYNAMIC</IPV4ADDIND><RELCLS>ACKALLPRODT</RELCLS><DELAYCLS>DELAY4</DELAYCLS><PRECLS>HIGH</PRECLS><PEAKTHR>256000 OCT</PEAKTHR><MEANTHR>BEST_EFFORT</MEANTHR><ARPRIORITY>NORMAL</ARPRIORITY><ERRSDU>NO</ERRSDU><DELIVERY>NO</DELIVERY><TRAFFICCLS>INTERACT</TRAFFICCLS><MAXSDUSIZE>1500 OCT</MAXSDUSIZE><MAXBRUPL>2048K</MAXBRUPL><MAXBRDWL>2048K</MAXBRDWL><RESBER>0.00001</RESBER><SDUERR>0.0001</SDUERR><TRANSFERDEL>10MS</TRANSFERDEL><TRAFFICPRI>PRIORITY2</TRAFFICPRI><MAXGBRUPL>384K</MAXGBRUPL><MAXGBRDWL>384K</MAXGBRDWL><APN>CMNET</APN><VPLMN>FALSE</VPLMN><CHARGE>NONE</CHARGE></Group><Group><CNTXID>2</CNTXID><QOSTPLID>33</QOSTPLID><PDPTYPE>IPV4</PDPTYPE><IPV4ADDIND>DYNAMIC</IPV4ADDIND><RELCLS>ACKALLPRODT</RELCLS><DELAYCLS>DELAY4</DELAYCLS><PRECLS>HIGH</PRECLS><PEAKTHR>256000 OCT</PEAKTHR><MEANTHR>BEST_EFFORT</MEANTHR><ARPRIORITY>NORMAL</ARPRIORITY><ERRSDU>NO</ERRSDU><DELIVERY>NO</DELIVERY><TRAFFICCLS>INTERACT</TRAFFICCLS><MAXSDUSIZE>1500 OCT</MAXSDUSIZE><MAXBRUPL>2048K</MAXBRUPL><MAXBRDWL>2048K</MAXBRDWL><RESBER>0.00001</RESBER><SDUERR>0.0001</SDUERR><TRANSFERDEL>10MS</TRANSFERDEL><TRAFFICPRI>PRIORITY2</TRAFFICPRI><MAXGBRUPL>384K</MAXGBRUPL><MAXGBRDWL>384K</MAXGBRDWL><APN>CMWAP</APN><VPLMN>FALSE</VPLMN><CHARGE>NONE</CHARGE></Group><Group><CNTXID>3</CNTXID><QOSTPLID>33</QOSTPLID><PDPTYPE>IPV4</PDPTYPE><IPV4ADDIND>DYNAMIC</IPV4ADDIND><RELCLS>ACKALLPRODT</RELCLS><DELAYCLS>DELAY4</DELAYCLS><PRECLS>HIGH</PRECLS><PEAKTHR>256000 OCT</PEAKTHR><MEANTHR>BEST_EFFORT</MEANTHR><ARPRIORITY>NORMAL</ARPRIORITY><ERRSDU>NO</ERRSDU><DELIVERY>NO</DELIVERY><TRAFFICCLS>INTERACT</TRAFFICCLS><MAXSDUSIZE>1500 OCT</MAXSDUSIZE><MAXBRUPL>2048K</MAXBRUPL><MAXBRDWL>2048K</MAXBRDWL><RESBER>0.00001</RESBER><SDUERR>0.0001</SDUERR><TRANSFERDEL>10MS</TRANSFERDEL><TRAFFICPRI>PRIORITY2</TRAFFICPRI><MAXGBRUPL>384K</MAXGBRUPL><MAXGBRDWL>384K</MAXGBRDWL><APN>CMMM</APN><VPLMN>FALSE</VPLMN><CHARGE>NONE</CHARGE></Group></ResultData></Result></LST_GPRSResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

LST_SUB_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><LST_SUBResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc><ResultData><Group><Group><HLRSN>5</HLRSN></Group><Group><IMSI>460001279036491</IMSI></Group><Group><ISDN>8613901193051</ISDN></Group><Group><NAM>BOTH</NAM><CATEGORY>COMMON</CATEGORY></Group></Group><Group Name ="LOCK" ><IC>FALSE</IC><OC>FALSE</OC><GPRSLOCK>FALSE</GPRSLOCK><EPSLOCK>FALSE</EPSLOCK><NON3GPPLOCK>FALSE</NON3GPPLOCK></Group><Group Name ="SABLOCK" ><IC>FALSE</IC><OC>FALSE</OC></Group><Group Name ="Basic Service" ><Group Name ="TSCODE:" ><TS>Telephony (TS11)</TS><TS>Emergency Call (TS12)</TS><TS>Short Message MT_PP (TS21)</TS><TS>Short Message MO_PP (TS22)</TS></Group></Group><Group Name ="DefaultCall" ><DEFAULTCALL>Telephony (TS11)</DEFAULTCALL></Group><Group Name ="ODB Data" ><ODBSS>FALSE</ODBSS><ODBOC>NOBOC</ODBOC><ODBIC>NOBIC</ODBIC><ODBPB1>FALSE</ODBPB1><ODBPB2>FALSE</ODBPB2><ODBPB3>TRUE</ODBPB3><ODBPB4>FALSE</ODBPB4><ODBENTE>FALSE</ODBENTE><ODBINFO>FALSE</ODBINFO><ODBROAM>NOBAR</ODBROAM><ODBRCF>BRICFEXHC</ODBRCF><ODBPOS>NOBPOS</ODBPOS></Group><Group Name ="RR Data" ><RROption>ALL_PLMNS</RROption></Group><Group Name ="SS Data" ><Group Name ="CFU" ><CFU>PROV</CFU><NCS>FALSE</NCS><COU>SUBSCRIBER</COU><Group><BSG>ALL</BSG><STATUS>PROV</STATUS></Group></Group><Group Name ="CFB" ><CFB>PROV</CFB><NFS>FALSE</NFS><NCS>FALSE</NCS><COU>SUBSCRIBER</COU><Group><BSG>ALL</BSG><STATUS>PROV</STATUS></Group></Group><Group Name ="CFNRY" ><CFNRY>PROV</CFNRY><NFS>FALSE</NFS><NCS>FALSE</NCS><COU>SUBSCRIBER</COU><Group><BSG>ALL</BSG><STATUS>PROV</STATUS></Group></Group><Group Name ="CFNRC" ><CFNRC>PROV</CFNRC><NCS>FALSE</NCS><COU>SUBSCRIBER</COU><Group><BSG>ALL</BSG><STATUS>PROV</STATUS></Group></Group><Group Name ="CFD" ><CFD>PROV</CFD><NFS>FALSE</NFS><NCS>FALSE</NCS><SUPINTERCFD>FALSE</SUPINTERCFD><VALIDCCF>CFNRc</VALIDCCF><Group><FTN>8613800100103</FTN><BSG>TS1X</BSG><STATUS>PROV | REG | ACT</STATUS><NotReplyTime>20</NotReplyTime></Group></Group><Group Name ="BAOC" ><BAOC>PROV</BAOC></Group><Group Name ="BOIC" ><BOIC>PROV</BOIC></Group><Group Name ="BOICEXHC" ><BOICEXHC>PROV</BOICEXHC></Group><Group Name ="BORO" ><BORO>NOTPROV</BORO></Group><Group Name ="BAIC" ><BAIC>PROV</BAIC></Group><Group Name ="BICROAM" ><BICROAM>PROV</BICROAM></Group><Group Name ="CW" ><CW>PROV</CW><Group><BSG>TS1X</BSG><STATUS>PROV | ACT</STATUS></Group></Group><Group Name ="PLMNSS" ><plmn-specificSS-1>NOTPROV</plmn-specificSS-1><plmn-specificSS-2>NOTPROV</plmn-specificSS-2><plmn-specificSS-3>NOTPROV</plmn-specificSS-3><plmn-specificSS-4>NOTPROV</plmn-specificSS-4><plmn-specificSS-5>NOTPROV</plmn-specificSS-5><plmn-specificSS-6>NOTPROV</plmn-specificSS-6><plmn-specificSS-7>NOTPROV</plmn-specificSS-7><plmn-specificSS-8>NOTPROV</plmn-specificSS-8><plmn-specificSS-9>NOTPROV</plmn-specificSS-9><plmn-specificSS-A>NOTPROV</plmn-specificSS-A><plmn-specificSS-B>NOTPROV</plmn-specificSS-B><plmn-specificSS-C>NOTPROV</plmn-specificSS-C><plmn-specificSS-D>NOTPROV</plmn-specificSS-D><plmn-specificSS-E>PROV</plmn-specificSS-E><plmn-specificSS-F>NOTPROV</plmn-specificSS-F><allplmn-specificSS>NOTPROV</allplmn-specificSS></Group><Group Name ="OTHER SS" ><CBCOU>SUBSCRIBER</CBCOU><CLIP>PROV</CLIP><CLIPOVERRIDE>FALSE</CLIPOVERRIDE><CLIR>NOTPROV</CLIR><COLP>NOTPROV</COLP><COLR>NOTPROV</COLR><HOLD>PROV</HOLD><MPTY>PROV</MPTY><EMLPP>NOTPROV</EMLPP><EMLPP_COU>SUBSCRIBER</EMLPP_COU></Group></Group><Group Name ="ARD" ><ARD>NOTPROV</ARD></Group><Group Name ="Other Service Data" ><CARP>NOTPROV</CARP></Group><Group Name ="PS Data" ><CHARGE_GLOBAL>PREPAID</CHARGE_GLOBAL><Group><CNTXID>1</CNTXID><APNQOSTPLID>511</APNQOSTPLID></Group><Group><CNTXID>2</CNTXID><APNQOSTPLID>510</APNQOSTPLID></Group><Group><CNTXID>3</CNTXID><APNQOSTPLID>513</APNQOSTPLID></Group></Group><Group Name ="EPS Data" ><CHARGE_GLOBAL>PREPAID</CHARGE_GLOBAL><AMBRMAXREQBWUL_GLOBAL>256000000</AMBRMAXREQBWUL_GLOBAL><AMBRMAXREQBWDL_GLOBAL>256000000</AMBRMAXREQBWDL_GLOBAL><DEFAULTCNTXID>1</DEFAULTCNTXID><Group><CNTXID>1</CNTXID><APNQOSTPLID>903</APNQOSTPLID></Group><Group><CNTXID>2</CNTXID><APNQOSTPLID>904</APNQOSTPLID></Group></Group><Group Name ="CSLocationData" ><VlrNum>8613441430</VlrNum><MscNum>8613441430</MscNum><MsPurgedForNonGprs>FALSE</MsPurgedForNonGprs></Group><Group Name ="PSLocationData" ><PURGEDONSGSN>FALSE</PURGEDONSGSN></Group><Group Name ="EPSLocationData" ><MMEHOST>mmec46.mmegi0103.mme.epc.mnc000.mcc460.3gppnetwork.org</MMEHOST><MMEREALM>epc.mnc000.mcc460.3gppnetwork.org</MMEREALM><PURGEDONMME>FALSE</PURGEDONMME></Group></ResultData></Result></LST_SUBResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

LST_EPS_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><LST_EPSResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc><ResultData><IMSI>460001279036491</IMSI><ISDN>8613901193051</ISDN><CHARGE_GLOBAL>PREPAID</CHARGE_GLOBAL><AMBRMAXREQBWUL_GLOBAL>256000000</AMBRMAXREQBWUL_GLOBAL><AMBRMAXREQBWDL_GLOBAL>256000000</AMBRMAXREQBWDL_GLOBAL><DEFAULTCNTXID>1</DEFAULTCNTXID><Group><CNTXID>1</CNTXID><PDNTYPE>IPV4IPV6</PDNTYPE><QOSTPLID>1</QOSTPLID><IPV4ADDIND>DYNAMIC</IPV4ADDIND><QOSCLASUID>9</QOSCLASUID><PRILEVEL>3</PRILEVEL><PREEMPTIONVUL>ENABLE</PREEMPTIONVUL><AMBRMAXUL>256000000</AMBRMAXUL><AMBRMAXDL>256000000</AMBRMAXDL><APN>CMNET</APN></Group><Group><CNTXID>2</CNTXID><PDNTYPE>IPV4IPV6</PDNTYPE><QOSTPLID>1</QOSTPLID><IPV4ADDIND>DYNAMIC</IPV4ADDIND><QOSCLASUID>9</QOSCLASUID><PRILEVEL>3</PRILEVEL><PREEMPTIONVUL>ENABLE</PREEMPTIONVUL><AMBRMAXUL>256000000</AMBRMAXUL><AMBRMAXDL>256000000</AMBRMAXDL><APN>CMWAP</APN></Group></ResultData></Result></LST_EPSResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

LST_CFALL_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><LST_CFALLResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc><ResultData><Group><IMSI>460001279036491</IMSI><ISDN>8613901193051</ISDN></Group><Group Name ="CFU" ><NCS>FALSE</NCS></Group><Group><FTN>&lt;NULL&gt;</FTN><BSG>ALL BS</BSG><STATUS>PROV</STATUS></Group><Group Name ="CFB" ><NFS>FALSE</NFS><NCS>FALSE</NCS></Group><Group><FTN>&lt;NULL&gt;</FTN><BSG>ALL BS</BSG><STATUS>PROV</STATUS></Group><Group Name ="CFNRY" ><NFS>FALSE</NFS><NCS>FALSE</NCS></Group><Group><FTN>&lt;NULL&gt;</FTN><BSG>ALL BS</BSG><STATUS>PROV</STATUS></Group><Group Name ="CFNRC" ><NCS>FALSE</NCS></Group><Group><FTN>&lt;NULL&gt;</FTN><BSG>ALL BS</BSG><STATUS>PROV</STATUS></Group><Group Name ="CFD" ><NFS>FALSE</NFS><NCS>FALSE</NCS><VALIDCCF>CFNRc</VALIDCCF></Group><Group><FTN>8613800100103</FTN><BSG>TS 1X</BSG><STATUS>PROV | REG | ACT</STATUS><NOREPTIME>20</NOREPTIME></Group></ResultData></Result></LST_CFALLResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

LST_CBAR_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><LST_CBARResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc><ResultData><IMSI>460001279036491</IMSI><ISDN>8613901193051</ISDN><Group Name ="BAOC" ><ALL_BS>PROV</ALL_BS></Group><Group Name ="BOIC" ><ALL_BS>PROV</ALL_BS></Group><Group Name ="BOICExHC" ><ALL_BS>PROV</ALL_BS></Group><Group Name ="BAIC" ><ALL_BS>PROV</ALL_BS></Group><Group Name ="BICROAM" ><ALL_BS>PROV</ALL_BS></Group></ResultData></Result></LST_CBARResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

COMM_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><HWHSSCMDResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>0</ResultCode><ResultDesc>SUCCESS0001:Operation is successful</ResultDesc><p243:ResultCode>0</p243:ResultCode><m:ResultCode>0</m:ResultCode><p243:ResultCode>0</p243:ResultCode></Result></HWHSSCMDResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

ERR3037_BODY
<?xml version="1.0" ?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><SOAP-ENV:Body><HWHSSCMDResponse xmlns="http://www.chinamobile.com/HSS/" ><Result><ResultCode>3037</ResultCode><ResultDesc>ERR3037:Database updated but network update failure. Indication: operator should send cancellocation</ResultDesc></Result></HWHSSCMDResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

ADD_SBR22004_BODY
<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><SOAP-ENV:Header><MessageID xmlns="http://www.chinamobile.com/IMS/VoLTEAS/">4019132237</MessageID></SOAP-ENV:Header><SOAP-ENV:Body><m:ADD_SBRResponse xmlns:m="http://www.chinamobile.com/IMS/VoLTEAS/"><m:Result><m:ResultCode>10010505</m:ResultCode><m:ResultDesc>网元命令执行失败，详细信息：῍-^\ Result/ResultCode=22004; Result/ResultDesc=BJMMTEL2-用户已经存在⿍-^B”⋭^@M-^B</m:ResultDesc></m:Result></m:ADD_SBRResponse></SOAP-ENV:Body></SOAP-ENV:Envelope>

#mapping of request and response
LGI LGI_HEAD LGI_BODY
LST_GPRS COMM_HEAD LST_GPRS_BODY
LST_SUB COMM_HEAD LST_SUB_BODY
LST_EPS COMM_HEAD LST_EPS_BODY
LST_CFALL COMM_HEAD LST_CFALL_BODY
LST_CBAR COMM_HEAD LST_CBAR_BODY
MOD_CB COMM_HEAD COMM_BODY
ADD_SBR COMM_HEAD COMM_BODY
OTHER COMM_HEAD COMM_BODY

